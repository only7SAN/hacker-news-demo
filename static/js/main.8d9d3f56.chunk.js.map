{"version":3,"sources":["page/layout/index.js","api/index.js","page/list/index.js","tool/index.js","page/item/comment-item/index.js","page/item/index.js","page/reply/index.js","index.js"],"names":["Layout","props","className","children","fetchApi","url","fetch","then","response","json","catch","err","Error","id","kid","List","useState","lists","setLists","useEffect","Api","data","map","item","to","useQuery","URLSearchParams","useLocation","search","html2Escape","sHtml","replace","c","CommentItem","React","memo","history","useHistory","detail","setDetail","isOpen","setIsOpen","hasChild","setHasChild","kids","length","by","onClick","dangerouslySetInnerHTML","__html","sanitizeHtml","text","push","Item","query","commentText","setCommentText","getDetail","get","handleTextChange","useCallback","e","target","value","submit","parentId","console","log","title","cols","rows","onChange","Reply","replyText","setReplyText","commentDetail","setCommentDetail","Promise","all","commentData","ReactDOM","render","path","component","document","getElementById"],"mappings":"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","file":"static/js/main.8d9d3f56.chunk.js","sourcesContent":["import React from 'react';\n\nimport './style.css';\n\n// 布局\nconst Layout = (props) => {\n  return (\n    <div className=\"layout-container\">\n      <header className=\"layout-header\">\n        <div>hacker-news</div>\n      </header>\n      <div className=\"layout-content\">{props.children}</div>\n    </div>\n  );\n};\n\nexport default Layout;\n","const fetchApi = (url) => {\n  return fetch(url)\n    .then(function(response) {\n      return response.json();\n    })\n    .catch(err => {\n      // 错误处理\n      throw new Error()\n    });\n};\n\nexport default {\n  // 获取新闻\n  getItem: (id) => fetchApi(`https://hacker-news.firebaseio.com/v0/item/${id}.json?print=pretty`),\n  // 获取评论\n  getComment: (kid) => fetchApi(`https://hacker-news.firebaseio.com/v0/item/${kid}.json?print=pretty`),\n  // 获取最新的新闻\n  getNews: () => fetchApi('https://hacker-news.firebaseio.com/v0/topstories.json?print=pretty'),\n  // 添加评论\n  writeComment: () => fetchApi(),\n  // 添加评论\n  replyComment: () => fetchApi(),\n}\n","import React, { useEffect, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport Api from '../../api';\n\nimport './style.css';\n\nconst List = () => {\n  const [lists, setLists] = useState([]);\n\n  useEffect(() => {\n    Api.getNews().then((data) => {\n      setLists(data);\n    })\n  }, []);\n\n  return (\n    <div className=\"App\">\n      {\n        lists.map(item => (\n          <div className=\"list-item\" key={item}>\n            <Link to={`/item?id=${item}`}>{item}</Link>\n          </div>\n        ))\n      }\n    </div>\n  );\n};\n\nexport default List;\n","import { useLocation } from 'react-router-dom';\n\nexport const useQuery = () => {\n  return new URLSearchParams(useLocation().search);\n};\n\n//HTML标签转义（< -> &lt;）\nexport const html2Escape = (sHtml) => {\n  return sHtml.replace(/[<>&\"]/g,function(c){\n    return {'<':'&lt;','>':'&gt;','&':'&amp;','\"':'&quot;'}[c];\n  });\n};\n\n//HTML标签反转义（&lt; -> <）\nexport const escape2Html = (str) => {\n  var arrEntities={'lt':'<','gt':'>','nbsp':' ','amp':'&','quot':'\"'};\n  return str.replace(/&(lt|gt|nbsp|amp|quot);/ig,function(all,t){\n    return arrEntities[t];\n  });\n};\n\nexport function formatTime(time, option) {\n  if (`${time}`.length === 10) {\n    time = parseInt(time, 10) * 1000;\n  } else {\n    time = +time;\n  }\n  const d = new Date(time);\n  const now = Date.now();\n\n  const diff = (now - d) / 1000;\n\n  if (diff < 300) {\n    return 'last';\n  }\n  if (diff < 3600) {\n    // less 1 hour\n    return `${Math.floor(diff / 60)} minutes ago`;\n  }\n  if (diff < 3600 * 24) {\n    return `${Math.floor(diff / 3600)} hours ago`;\n  }\n  if (diff < 3600 * 24 * 2) {\n    return 'tomorrow';\n  }\n  if (option) {\n    return Date.parse(time);\n  }\n\n  return `${Number.parseInt(diff / 3600 / 24, 10)} days ago`;\n}\n","import React, { useEffect, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport sanitizeHtml from 'sanitize-html';\nimport Api from '../../../api';\nimport '../style.css';\n\n// comment 节点\nconst CommentItem = React.memo((props) => {\n  const history = useHistory();\n  const { kid, id } = props;\n\n  const [detail, setDetail] = useState(null);\n  // 展开、隐藏\n  const [isOpen, setIsOpen] = useState(true);\n  const [hasChild, setHasChild] = useState(false);\n\n  useEffect(() => {\n    Api.getComment(kid).then((data) => {\n      setDetail(data);\n      setHasChild(data.kids && data.kids.length > 0);\n    })\n  }, []);\n\n  const handleClick = () => {\n    setIsOpen(!isOpen)\n  };\n\n  const goReplyPage = () => {\n    history.push(`/reply?id=${id}&kid=${kid}`);\n  };\n\n  return detail && (\n    <div className=\"comment\">\n      <div className=\"comment-top\">\n        <div className=\"comment-title\">\n          ** {detail.by}\n          {hasChild && <div className=\"comment-change\" onClick={handleClick}>{isOpen ? '[收起]' : '[展开]'}</div>}\n        </div>\n        <div className=\"comment-content\" dangerouslySetInnerHTML={{ __html: sanitizeHtml(detail.text) }} />\n        <div className=\"comment-reply-btn\" onClick={goReplyPage}>reply</div>\n      </div>\n      {\n        hasChild && (\n          <div className={`comment-child ${isOpen ? 'comment-child-open' : 'comment-child-hide'}`}>\n            {\n              detail.kids.map(item =>(\n                <CommentItem key={item} kid={item} id={id} />\n              ))\n            }\n          </div>\n        )\n      }\n    </div>\n  );\n});\n\nexport default CommentItem;\n","import React, { useEffect, useState, useCallback } from 'react';\nimport Api from '../../api';\nimport { html2Escape } from '../../tool';\nimport { useQuery } from '../../tool';\nimport CommentItem from './comment-item';\n\n// item 页面\nconst Item = () => {\n  const query = useQuery();\n\n  const [commentText, setCommentText] = useState('');\n  const [detail, setDetail] = useState(null);\n\n  useEffect(() => {\n    getDetail();\n  }, []);\n\n  const getDetail = () => {\n    Api.getItem(query.get('id')).then((data) => {\n      setDetail(data);\n    })\n  };\n\n  const handleTextChange = useCallback((e) => {\n    setCommentText(e.target.value);\n  }, []);\n\n  const submit = useCallback(() => {\n    if (commentText) {\n      Api.writeComment({ parentId: detail.id, text: html2Escape(commentText) }).then(() => {\n        // 重置页面内容\n        getDetail();\n      }).catch((err) => { console.log('评论失败')})\n    } else {\n      console.log('please write something');\n    }\n  }, [commentText]);\n\n  return detail && (\n    <div className=\"detail\">\n      <div className=\"detail-top\">\n        <div>** {detail.title}</div>\n        <textarea cols={40} rows={8} value={commentText} onChange={handleTextChange} />\n        <div>If you haven't already, would you mind reading about HN's approach to comments and site guidelines?</div>\n        <button onClick={submit}>add comment</button>\n      </div>\n      {\n        detail && detail.kids && detail.kids.length > 0 && detail.kids.map(kid => (\n          <CommentItem key={kid} kid={kid} id={detail.id} />\n        ))\n      }\n    </div>\n  );\n}\n\nexport default Item;\n","import React, { useEffect, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport sanitizeHtml from 'sanitize-html';\nimport Api from '../../api';\nimport {html2Escape, useQuery} from '../../tool';\n\nimport './style.css';\n\n// 回复页面\nconst Reply = () => {\n  const query = useQuery();\n  const history = useHistory();\n\n  const [replyText, setReplyText] = useState('');\n  const [detail, setDetail] = useState(null);\n  const [commentDetail, setCommentDetail] = useState(null);\n\n  useEffect(() => {\n    getDetail();\n  }, []);\n\n  const getDetail = () => {\n    Promise.all([\n      Api.getItem(query.get('id')),\n      Api.getComment(query.get('kid')),\n    ]).then(([data, commentData]) => {\n      setDetail(data);\n      setCommentDetail(commentData);\n    })\n  };\n\n  const handleTextChange = (e) => {\n    setReplyText(e.target.value);\n  };\n\n  const submit = () => {\n    if (replyText) {\n      Api.replyComment({ parentId: detail.id, text: html2Escape(replyText) }).then(() => {\n        // 返回评论页面\n        history.push(`/item?id=${query.get('id')}`);\n      }).catch((err) => { console.log('回复失败')})\n    } else {\n      console.log('please write something');\n    }\n  };\n\n  return detail && commentDetail && (\n    <div className=\"reply-container\">\n      <div className=\"reply-title\">{detail.by} on: {detail.title} </div>\n      <div className=\"reply-content\" dangerouslySetInnerHTML={{ __html: sanitizeHtml(commentDetail.text) }} />\n      <textarea className=\"reply-textarea\" cols={40} rows={8} value={replyText} onChange={handleTextChange} />\n      <div>If you haven't already, would you mind reading about HN's approach to comments and site guidelines?</div>\n      <button className=\"reply-btn\" onClick={submit}>reply</button>\n    </div>\n  );\n};\n\nexport default Reply;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport {\n  BrowserRouter as Router,\n  Route,\n  Switch,\n} from 'react-router-dom';\n\n// 全局 css\nimport 'normalize.css';\nimport './index.css';\n\nimport Layout from './page/layout';\nimport List from './page/list';\nimport Item from './page/item';\nimport Reply from './page/reply';\n\nconst Wrapper = (props) => (\n  <Layout>\n    <Switch>\n      <Route path=\"/home\" component={List} />\n      <Route path=\"/item\" component={Item} />\n      <Route path=\"/reply\" component={Reply} />\n      <Route path=\"/\" component={List} />\n    </Switch>\n  </Layout>\n);\n\n\nReactDOM.render(\n  <Router>\n    <Route path=\"/\" component={Wrapper} />\n  </Router>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}